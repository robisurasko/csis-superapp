{"version":3,"file":"Popover-4a1551e7.js","sources":["../../../../frontend/src/components/frappe-ui/Popover.vue"],"sourcesContent":["<template>\n  <div ref=\"reference\">\n    <div\n      ref=\"target\"\n      :class=\"['flex', $attrs.class]\"\n      @click=\"updatePosition\"\n      @focusin=\"updatePosition\"\n      @keydown=\"updatePosition\"\n      @mouseover=\"onMouseover\"\n      @mouseleave=\"onMouseleave\"\n    >\n      <slot\n        name=\"target\"\n        v-bind=\"{ togglePopover, updatePosition, open, close, isOpen }\"\n      />\n    </div>\n    <teleport to=\"#frappeui-popper-root\">\n      <div\n        ref=\"popover\"\n        class=\"relative z-[100]\"\n        :class=\"[popoverContainerClass, popoverClass]\"\n        :style=\"{ minWidth: targetWidth ? targetWidth + 'px' : null }\"\n        @mouseover=\"pointerOverTargetOrPopup = true\"\n        @mouseleave=\"onMouseleave\"\n      >\n        <transition v-bind=\"popupTransition\">\n          <div v-show=\"isOpen\">\n            <slot\n              name=\"body\"\n              v-bind=\"{ togglePopover, updatePosition, open, close, isOpen }\"\n            >\n              <div class=\"rounded-lg border border-gray-100 bg-surface-white shadow-xl\">\n                <slot\n                  name=\"body-main\"\n                  v-bind=\"{\n                    togglePopover,\n                    updatePosition,\n                    open,\n                    close,\n                    isOpen,\n                  }\"\n                />\n              </div>\n            </slot>\n          </div>\n        </transition>\n      </div>\n    </teleport>\n  </div>\n</template>\n\n<script>\nimport { createPopper } from '@popperjs/core'\n\nexport default {\n  name: 'Popover',\n  inheritAttrs: false,\n  props: {\n    show: {\n      default: undefined,\n    },\n    trigger: {\n      type: String,\n      default: 'click', // click, hover\n    },\n    hoverDelay: {\n      type: Number,\n      default: 0,\n    },\n    leaveDelay: {\n      type: Number,\n      default: 0,\n    },\n    placement: {\n      type: String,\n      default: 'bottom-start',\n    },\n    popoverClass: [String, Object, Array],\n    transition: {\n      default: null,\n    },\n    hideOnBlur: {\n      default: true,\n    },\n  },\n  emits: ['open', 'close', 'update:show'],\n  expose: ['open', 'close'],\n  data() {\n    return {\n      popoverContainerClass: 'body-container',\n      showPopup: false,\n      targetWidth: null,\n      pointerOverTargetOrPopup: false,\n    }\n  },\n  watch: {\n    show(val) {\n      if (val) {\n        this.open()\n      } else {\n        this.close()\n      }\n    },\n  },\n  created() {\n    if (typeof window === 'undefined') return\n    if (!document.getElementById('frappeui-popper-root')) {\n      const root = document.createElement('div')\n      root.id = 'frappeui-popper-root'\n      document.body.appendChild(root)\n    }\n  },\n  mounted() {\n    this.listener = (e) => {\n      const clickedElement = e.target\n      const reference = this.$refs.reference\n      const popoverBody = this.$refs.popover\n      const insideClick =\n        clickedElement === reference ||\n        clickedElement === popoverBody ||\n        reference?.contains(clickedElement) ||\n        popoverBody?.contains(clickedElement)\n      if (insideClick) {\n        return\n      }\n\n      const root = document.getElementById('frappeui-popper-root')\n      const insidePopoverRoot = root.contains(clickedElement)\n      if (!insidePopoverRoot) {\n        return this.close()\n      }\n\n      const bodyClass = `.${this.popoverContainerClass}`\n      const clickedElementBody = clickedElement?.closest(bodyClass)\n      const currentPopoverBody = reference?.closest(bodyClass)\n      const isSiblingClicked =\n        clickedElementBody &&\n        currentPopoverBody &&\n        clickedElementBody === currentPopoverBody\n\n      if (isSiblingClicked) {\n        this.close()\n      }\n    }\n    if (this.hideOnBlur) {\n      document.addEventListener('click', this.listener)\n      document.addEventListener('mousedown', this.listener)\n    }\n    this.$nextTick(() => {\n      this.targetWidth = this.$refs['target'].clientWidth\n    })\n  },\n  beforeDestroy() {\n    this.popper && this.popper.destroy()\n    document.removeEventListener('click', this.listener)\n    document.removeEventListener('mousedown', this.listener)\n  },\n  computed: {\n    showPropPassed() {\n      return this.show != null\n    },\n    isOpen: {\n      get() {\n        if (this.showPropPassed) {\n          return this.show\n        }\n        return this.showPopup\n      },\n      set(val) {\n        val = Boolean(val)\n        if (this.showPropPassed) {\n          this.$emit('update:show', val)\n        } else {\n          this.showPopup = val\n        }\n        if (val === false) {\n          this.$emit('close')\n        } else if (val === true) {\n          this.$emit('open')\n        }\n      },\n    },\n    popupTransition() {\n      let templates = {\n        default: {\n          enterActiveClass: 'transition duration-150 ease-out',\n          enterFromClass: 'translate-y-1 opacity-0',\n          enterToClass: 'translate-y-0 opacity-100',\n          leaveActiveClass: 'transition duration-150 ease-in',\n          leaveFromClass: 'translate-y-0 opacity-100',\n          leaveToClass: 'translate-y-1 opacity-0',\n        },\n      }\n      if (typeof this.transition === 'string') {\n        return templates[this.transition]\n      }\n      return this.transition\n    },\n  },\n  methods: {\n    setupPopper() {\n      if (!this.popper) {\n        this.popper = createPopper(this.$refs.reference, this.$refs.popover, {\n          placement: this.placement,\n        })\n      } else {\n        this.updatePosition()\n      }\n    },\n    updatePosition() {\n      this.popper && this.popper.update()\n    },\n    togglePopover(flag) {\n      if (flag instanceof Event) {\n        flag = null\n      }\n      if (flag == null) {\n        flag = !this.isOpen\n      }\n      flag = Boolean(flag)\n      if (flag) {\n        this.open()\n      } else {\n        this.close()\n      }\n    },\n    open() {\n      this.isOpen = true\n      this.$nextTick(() => this.setupPopper())\n    },\n    close() {\n      this.isOpen = false\n    },\n    onMouseover() {\n      this.pointerOverTargetOrPopup = true\n      if (this.leaveTimer) {\n        clearTimeout(this.leaveTimer)\n        this.leaveTimer = null\n      }\n      if (this.trigger === 'hover') {\n        if (this.hoverDelay) {\n          this.hoverTimer = setTimeout(() => {\n            if (this.pointerOverTargetOrPopup) {\n              this.open()\n            }\n          }, Number(this.hoverDelay) * 1000)\n        } else {\n          this.open()\n        }\n      }\n    },\n    onMouseleave(e) {\n      this.pointerOverTargetOrPopup = false\n      if (this.hoverTimer) {\n        clearTimeout(this.hoverTimer)\n        this.hoverTimer = null\n      }\n      if (this.trigger === 'hover') {\n        if (this.leaveTimer) {\n          clearTimeout(this.leaveTimer)\n        }\n        if (this.leaveDelay) {\n          this.leaveTimer = setTimeout(() => {\n            if (!this.pointerOverTargetOrPopup) {\n              this.close()\n            }\n          }, Number(this.leaveDelay) * 1000)\n        } else {\n          if (!this.pointerOverTargetOrPopup) {\n            this.close()\n          }\n        }\n      }\n    },\n  },\n}\n</script>\n"],"names":["_sfc_main","val","root","e","clickedElement","reference","popoverBody","bodyClass","clickedElementBody","currentPopoverBody","templates","createPopper","flag","_hoisted_1","_hoisted_2","_openBlock","_createElementBlock","_createElementVNode","_normalizeClass","_ctx","$options","args","_renderSlot","_normalizeProps","_guardReactiveProps","_createBlock","_Teleport","$data","$props","_normalizeStyle","_createVNode","_Transition","_withCtx"],"mappings":"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"}