import{_ as Q,a as H}from"./ViewControls-20f61d89.js";import{_ as J}from"./CustomActions-4107b940.js";import{O as G}from"./OrganizationsIcon-b5a4c50f.js";import{_ as K}from"./LayoutHeader-448e93da.js";import{_ as X}from"./OrganizationModal-b2c5c5b4.js";import{_ as Y}from"./QuickEntryModal-157d8856.js";import{_ as Z}from"./AddressModal-fd287daa.js";import{m as q,h as ee,i as I,j as B,s as te,k as le,l as k,e as x,f as d,c as C,b as o,w as m,u as y,F as R,r as oe,g as b,n as S,p as M,_ as ae,d as D,t as P,q as se,E as ne}from"./index-85632e04.js";import{_ as ie,H as h,a as ue,b as re,c as de,d as me,e as pe,f as fe}from"./ListRows-e4885bb7.js";import{a as ve,b as ye,f as j,w as ke,t as ce}from"./index-31644aa3.js";import{_ as ge}from"./Dropdown.vue_vue_type_script_setup_true_lang-4f930b23.js";import{_ as Ce}from"./ListFooter-fc834b42.js";import"./FadedScrollableDiv-f3f408b5.js";import"./IconPicker-0c2832fa.js";import"./Popover-4a1551e7.js";import"./Link-4317fd36.js";import"./DragVerticalIcon-e7d3e46c.js";import"./PinIcon-6c6ca639.js";import"./DetailsIcon-404b02bf.js";import"./settings-5fcce07e.js";import"./Section-7d029c27.js";import"./IndicatorIcon-99f76624.js";import"./AssignmentModal-f44425e3.js";import"./label-f9f1f609.js";const _e={key:0},we=["onClick"],Ve={key:1},be={key:2},Me=["onClick"],$e={__name:"OrganizationsListView",props:q({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:q(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(p,{expose:A,emit:L}){const f=L,$=ee(),_=I(p,"modelValue"),c=I(p,"list"),z=B(()=>{var u,a;return!!((a=(u=c.value.params)==null?void 0:u.filters)!=null&&a._liked_by)}),{user:i}=te();function U(u){if(u)return JSON.parse(u).includes(i)}le(_,(u,a)=>{u!==a&&f("updatePageCount",u)});const w=k(null);return A({customListActions:B(()=>{var u;return(u=w.value)==null?void 0:u.customListActions})}),(u,a)=>{const v=x("Button"),F=x("FormControl");return d(),C(R,null,[o(y(pe),{columns:p.columns,rows:p.rows,options:{getRowRoute:s=>({name:"Organization",params:{organizationId:s.name},query:{view:y($).query.view,viewType:y($).params.viewType}}),selectable:p.options.selectable,showTooltip:p.options.showTooltip,resizeColumn:p.options.resizeColumn},"row-key":"name","onUpdate:selections":a[2]||(a[2]=s=>f("selectionsChanged",s))},{default:m(()=>[o(y(ie),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:a[1]||(a[1]=s=>f("columnWidthUpdated"))},{default:m(()=>[(d(!0),C(R,null,oe(p.columns,s=>(d(),b(y(ue),{key:s.key,item:s,onColumnWidthUpdated:l=>f("columnWidthUpdated",s)},{default:m(()=>[s.key=="_liked_by"?(d(),b(v,{key:0,variant:"ghosted",class:S(["!h-4",z.value?"fill-red-500":"fill-white"]),onClick:a[0]||(a[0]=()=>f("applyLikeFilter"))},{default:m(()=>[o(h,{class:"h-4 w-4"})]),_:1},8,["class"])):M("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),o(re,{class:"mx-3 sm:mx-5",rows:p.rows,doctype:"CRM Organization"},{default:m(({idx:s,column:l,item:e})=>[o(y(de),{item:e,align:l.align},{prefix:m(()=>[l.key==="organization_name"?(d(),C("div",_e,[e.label?(d(),b(y(ve),{key:0,class:"flex items-center",image:e.logo,label:e.label,size:"sm"},null,8,["image","label"])):M("",!0)])):M("",!0)]),default:m(({label:V})=>[["modified","creation"].includes(l.key)?(d(),C("div",{key:0,class:"truncate text-base",onClick:r=>f("applyFilter",{event:r,idx:s,column:l,item:e,firstColumn:p.columns[0]})},[o(y(ae),{text:e.label},{default:m(()=>[D("div",null,P(e.timeAgo),1)]),_:2},1032,["text"])],8,we)):l.type==="Check"?(d(),C("div",Ve,[o(F,{type:"checkbox",modelValue:e,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):l.key==="_liked_by"?(d(),C("div",be,[l.key=="_liked_by"?(d(),b(v,{key:0,variant:"ghosted",class:S(U(e)?"fill-red-500":"fill-white"),onClick:se(()=>f("likeDoc",{name:u.row.name,liked:U(e)}),["stop","prevent"])},{default:m(()=>[o(h,{class:"h-4 w-4"})]),_:2},1032,["class","onClick"])):M("",!0)])):(d(),C("div",{key:3,class:"truncate text-base",onClick:r=>f("applyFilter",{event:r,idx:s,column:l,item:e,firstColumn:p.columns[0]})},P(V),9,Me))]),_:2},1032,["item","align"])]),_:1},8,["rows"]),o(y(me),null,{actions:m(({selections:s,unselectAll:l})=>[o(y(ge),{options:w.value.bulkActions(s,l)},{default:m(()=>[o(v,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["columns","rows","options"]),o(y(Ce),{class:"border-t sm:px-5 px-3 py-2",modelValue:_.value,"onUpdate:modelValue":a[3]||(a[3]=s=>_.value=s),options:{rowCount:p.options.rowCount,totalCount:p.options.totalCount},onLoadMore:a[4]||(a[4]=s=>f("loadMore"))},null,8,["modelValue","options"]),o(fe,{ref_key:"listBulkActionsRef",ref:w,modelValue:c.value,"onUpdate:modelValue":a[5]||(a[5]=s=>c.value=s),doctype:"CRM Organization",options:{hideAssign:!0}},null,8,["modelValue"])],64)}}},Ue={key:1,class:"flex h-full items-center justify-center"},ze={class:"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4"},Ye={__name:"Organizations",setup(p){const{getFormattedPercent:A,getFormattedFloat:L,getFormattedCurrency:f}=ye("CRM Organization"),$=k(null),_=k(!1),c=k(!1),z=k(!1),i=k({}),U=k({}),w=k(1),u=k(1),a=k(20),v=k(null),F=B(()=>{var l,e,V;return!((e=(l=i.value)==null?void 0:l.data)!=null&&e.data)||!["list","group_by"].includes(i.value.data.view_type)?[]:(V=i.value)==null?void 0:V.data.data.map(r=>{var O;let t={};return(O=i.value)==null||O.data.rows.forEach(n=>{var E,T,W;t[n]=r[n];let g=(W=(T=(E=i.value)==null?void 0:E.data.columns)==null?void 0:T.find(N=>(N.key||N.value)==n))==null?void 0:W.type;g&&["Date","Datetime"].includes(g)&&!["modified","creation"].includes(n)&&(t[n]=j(r[n],"",!0,g=="Datetime")),g&&g=="Currency"&&(t[n]=f(n,r)),g&&g=="Float"&&(t[n]=L(n,r)),g&&g=="Percent"&&(t[n]=A(n,r)),n==="organization_name"?t[n]={label:r.organization_name,logo:r.organization_logo}:n==="website"?t[n]=ke(r.website):["modified","creation"].includes(n)&&(t[n]={label:j(r[n]),timeAgo:__(ce(r[n]))})}),t})});async function s(l){l&&(l=await ne("frappe.client.get",{doctype:"Address",name:l})),z.value=!0,U.value=l||{}}return(l,e)=>{const V=x("FeatherIcon"),r=x("Button");return d(),C(R,null,[o(K,null,{"left-header":m(()=>[o(H,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=t=>v.value=t),routeName:"Organizations"},null,8,["modelValue"])]),"right-header":m(()=>{var t;return[(t=$.value)!=null&&t.customListActions?(d(),b(J,{key:0,actions:$.value.customListActions},null,8,["actions"])):M("",!0),o(r,{variant:"solid",label:l.__("Create"),onClick:e[1]||(e[1]=O=>_.value=!0)},{prefix:m(()=>[o(V,{name:"plus",class:"h-4"})]),_:1},8,["label"])]}),_:1}),o(Q,{ref_key:"viewControls",ref:v,modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=t=>i.value=t),loadMore:w.value,"onUpdate:loadMore":e[3]||(e[3]=t=>w.value=t),resizeColumn:u.value,"onUpdate:resizeColumn":e[4]||(e[4]=t=>u.value=t),updatedPageCount:a.value,"onUpdate:updatedPageCount":e[5]||(e[5]=t=>a.value=t),doctype:"CRM Organization"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),i.value.data&&F.value.length?(d(),b($e,{key:0,ref_key:"organizationsListView",ref:$,modelValue:i.value.data.page_length_count,"onUpdate:modelValue":e[6]||(e[6]=t=>i.value.data.page_length_count=t),list:i.value,"onUpdate:list":e[7]||(e[7]=t=>i.value=t),rows:F.value,columns:i.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:i.value.data.row_count,totalCount:i.value.data.total_count},onLoadMore:e[8]||(e[8]=()=>w.value++),onColumnWidthUpdated:e[9]||(e[9]=()=>u.value++),onUpdatePageCount:e[10]||(e[10]=t=>a.value=t),onApplyFilter:e[11]||(e[11]=t=>v.value.applyFilter(t)),onApplyLikeFilter:e[12]||(e[12]=t=>v.value.applyLikeFilter(t)),onLikeDoc:e[13]||(e[13]=t=>v.value.likeDoc(t)),onSelectionsChanged:e[14]||(e[14]=t=>v.value.updateSelections(t))},null,8,["modelValue","list","rows","columns","options"])):i.value.data?(d(),C("div",Ue,[D("div",ze,[o(G,{class:"h-10 w-10"}),D("span",null,P(l.__("No {0} Found",[l.__("Organizations")])),1),o(r,{label:l.__("Create"),onClick:e[15]||(e[15]=t=>_.value=!0)},{prefix:m(()=>[o(V,{name:"plus",class:"h-4"})]),_:1},8,["label"])])])):M("",!0),o(X,{modelValue:_.value,"onUpdate:modelValue":e[16]||(e[16]=t=>_.value=t),showQuickEntryModal:c.value,"onUpdate:showQuickEntryModal":e[17]||(e[17]=t=>c.value=t),onOpenAddressModal:e[18]||(e[18]=t=>s(t))},null,8,["modelValue","showQuickEntryModal"]),c.value?(d(),b(Y,{key:2,modelValue:c.value,"onUpdate:modelValue":e[19]||(e[19]=t=>c.value=t),doctype:"CRM Organization"},null,8,["modelValue"])):M("",!0),o(Z,{modelValue:z.value,"onUpdate:modelValue":e[20]||(e[20]=t=>z.value=t),address:U.value,"onUpdate:address":e[21]||(e[21]=t=>U.value=t)},null,8,["modelValue","address"])],64)}}};export{Ye as default};
//# sourceMappingURL=Organizations-8ac7fc1c.js.map
