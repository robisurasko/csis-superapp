import{F as j}from"./QuickEntryModal-157d8856.js";import{E as A}from"./DragVerticalIcon-e7d3e46c.js";import{u as D}from"./index-31644aa3.js";import{i as z}from"./Link-4317fd36.js";import{K as O,m as C,B as R,i as g,l as k,z as S,k as T,e as p,f as _,g as f,w as v,d as c,t as U,u as r,b as d,p as w,E as J,I as K,J as M}from"./index-85632e04.js";const L={class:"bg-surface-modal px-4 pb-6 pt-5 sm:px-6"},$={class:"mb-5 flex items-center justify-between"},q={class:"text-2xl font-semibold leading-6 text-ink-gray-9"},G={class:"flex items-center gap-1"},H={class:"px-4 pb-7 pt-4 sm:px-6"},P={class:"space-y-2"},W={__name:"ContactModal",props:C({contact:{type:Object,default:{}},options:{type:Object,default:{redirect:!0,afterInsert:()=>{}}}},{modelValue:{},modelModifiers:{},showQuickEntryModal:{},showQuickEntryModalModifiers:{}}),emits:C(["openAddressModal"],["update:modelValue","update:showQuickEntryModal"]),setup(u,{emit:x}){const i=u,y=x,{isManager:E}=D(),V=R(),s=g(u,"modelValue"),I=k(!1);let e=k({});async function Q(){e.value.email_id&&(e.value.email_ids=[{email_id:e.value.email_id}],delete e.value.email_id),e.value.mobile_no&&(e.value.phone_nos=[{phone:e.value.mobile_no}],delete e.value.mobile_no);const a=await J("frappe.client.insert",{doc:{doctype:"Contact",...e.value}});a.name&&(K("contact_created"),B(a))}function B(a){var t,l;(l=(t=i.contact)==null?void 0:t.reload)==null||l.call(t),a.name&&i.options.redirect&&V.push({name:"Contact",params:{contactId:a.name}}),s.value=!1,i.options.afterInsert&&i.options.afterInsert(a)}const h=S({url:"crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_fields_layout",cache:["QuickEntry","Contact"],params:{doctype:"Contact",type:"Quick Entry"},auto:!0,transform:a=>a.forEach(t=>{t.sections.forEach(l=>{l.columns.forEach(m=>{m.fields.forEach(o=>{o.fieldname=="email_id"||o.fieldname=="mobile_no"?o.read_only=!1:o.fieldname=="address"?(o.create=(n,b)=>{e.value.address=n,y("openAddressModal"),s.value=!1,b()},o.edit=n=>{y("openAddressModal",n),s.value=!1}):o.fieldtype==="Table"&&(e.value[o.fieldname]=[])})})})})});T(()=>s.value,a=>{a&&M(()=>{e.value={...i.contact.data}})});const F=g(u,"showQuickEntryModal");function N(){F.value=!0,M(()=>s.value=!1)}return(a,t)=>{const l=p("Button"),m=p("FeatherIcon"),o=p("Dialog");return _(),f(o,{modelValue:s.value,"onUpdate:modelValue":t[1]||(t[1]=n=>s.value=n),options:{size:"xl"}},{body:v(()=>{var n;return[c("div",L,[c("div",$,[c("div",null,[c("h3",q,U(a.__("New Contact")),1)]),c("div",G,[r(E)()&&!r(z)?(_(),f(l,{key:0,variant:"ghost",class:"w-7",onClick:N},{default:v(()=>[d(A,{class:"h-4 w-4"})]),_:1})):w("",!0),d(l,{variant:"ghost",class:"w-7",onClick:t[0]||(t[0]=b=>s.value=!1)},{default:v(()=>[d(m,{name:"x",class:"h-4 w-4"})]),_:1})])]),(n=r(h).data)!=null&&n.length?(_(),f(j,{key:0,tabs:r(h).data,data:r(e),doctype:"Contact"},null,8,["tabs","data"])):w("",!0)]),c("div",H,[c("div",P,[d(l,{class:"w-full",variant:"solid",label:a.__("Create"),loading:I.value,onClick:Q},null,8,["label","loading"])])])]}),_:1},8,["modelValue"])}}},te=O(W,[["__scopeId","data-v-a95342b7"]]);export{te as C};
//# sourceMappingURL=ContactModal-e2b879e7.js.map
