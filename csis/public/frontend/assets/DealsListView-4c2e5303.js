import{m as $,h as q,i as x,j as V,s as T,k as N,l as P,e as h,f as t,c as r,b as n,w as c,u,F as B,r as S,g as m,n as p,p as f,q as j,_ as H,d as O,t as F}from"./index-85632e04.js";import{_ as E,H as M,a as J,b as G,c as K,d as Q,e as X,f as Y}from"./ListRows-e4885bb7.js";import{_ as Z}from"./MultipleAvatar-8c461416.js";import{I as ee}from"./IndicatorIcon-99f76624.js";import{P as se}from"./PhoneIcon-cb5df69f.js";import{a as z}from"./index-31644aa3.js";import{_ as te}from"./Dropdown.vue_vue_type_script_setup_true_lang-4f930b23.js";import{_ as le}from"./ListFooter-fc834b42.js";const oe={key:0,class:"flex items-center"},ae={key:0},ne={key:1},ie={key:2},re={key:3},ue={key:4},de=["onClick"],ce={key:1,class:"truncate text-base"},me={key:2},fe=["onClick"],we={__name:"DealsListView",props:$({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:$(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(a,{expose:L,emit:A}){const d=A,w=q(),y=x(a,"modelValue"),_=x(a,"list"),U=V(()=>{var i,l;return!!((l=(i=_.value.params)==null?void 0:i.filters)!=null&&l._liked_by)}),{user:D}=T();function g(i){if(i)return JSON.parse(i).includes(D)}N(y,(i,l)=>{i!==l&&d("updatePageCount",i)});const C=P(null);return L({customListActions:V(()=>{var i;return(i=C.value)==null?void 0:i.customListActions})}),(i,l)=>{const v=h("Button"),R=h("Badge"),I=h("FormControl");return t(),r(B,null,[n(u(X),{class:p(i.$attrs.class),columns:a.columns,rows:a.rows,options:{getRowRoute:e=>({name:"Deal",params:{dealId:e.name},query:{view:u(w).query.view,viewType:u(w).params.viewType}}),selectable:a.options.selectable,showTooltip:a.options.showTooltip,resizeColumn:a.options.resizeColumn},"row-key":"name","onUpdate:selections":l[2]||(l[2]=e=>d("selectionsChanged",e))},{default:c(()=>[n(u(E),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:l[1]||(l[1]=e=>d("columnWidthUpdated"))},{default:c(()=>[(t(!0),r(B,null,S(a.columns,e=>(t(),m(u(J),{key:e.key,item:e,onColumnWidthUpdated:o=>d("columnWidthUpdated",e)},{default:c(()=>[e.key=="_liked_by"?(t(),m(v,{key:0,variant:"ghosted",class:p(["!h-4",U.value?"fill-red-500":"fill-white"]),onClick:l[0]||(l[0]=()=>d("applyLikeFilter"))},{default:c(()=>[n(M,{class:"h-4 w-4"})]),_:1},8,["class"])):f("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),n(G,{rows:a.rows,doctype:"CRM Deal"},{default:c(({idx:e,column:o,item:s,row:W})=>[o.key==="_assign"?(t(),r("div",oe,[n(Z,{avatars:s,size:"sm",onClick:b=>d("applyFilter",{event:b,idx:e,column:o,item:s,firstColumn:a.columns[0]})},null,8,["avatars","onClick"])])):(t(),m(u(K),{key:1,item:s,align:o.align},{prefix:c(()=>[o.key==="status"?(t(),r("div",ae,[n(ee,{class:p(s.color)},null,8,["class"])])):o.key==="organization"?(t(),r("div",ne,[s.label?(t(),m(u(z),{key:0,class:"flex items-center",image:s.logo,label:s.label,size:"sm"},null,8,["image","label"])):f("",!0)])):o.key==="deal_owner"?(t(),r("div",ie,[s.full_name?(t(),m(u(z),{key:0,class:"flex items-center",image:s.user_image,label:s.full_name,size:"sm"},null,8,["image","label"])):f("",!0)])):o.key==="mobile_no"?(t(),r("div",re,[n(se,{class:"h-4 w-4"})])):o.key==="_liked_by"?(t(),r("div",ue,[o.key=="_liked_by"?(t(),m(v,{key:0,variant:"ghosted",class:p(g(s)?"fill-red-500":"fill-white"),onClick:j(()=>d("likeDoc",{name:W.name,liked:g(s)}),["stop","prevent"])},{default:c(()=>[n(M,{class:"h-4 w-4"})]),_:2},1032,["class","onClick"])):f("",!0)])):f("",!0)]),default:c(({label:b})=>[["modified","creation","first_response_time","first_responded_on","response_by"].includes(o.key)?(t(),r("div",{key:0,class:"truncate text-base",onClick:k=>d("applyFilter",{event:k,idx:e,column:o,item:s,firstColumn:a.columns[0]})},[n(u(H),{text:s.label},{default:c(()=>[O("div",null,F(s.timeAgo),1)]),_:2},1032,["text"])],8,de)):o.key==="sla_status"?(t(),r("div",ce,[s.value?(t(),m(R,{key:0,variant:"subtle",theme:s.color,size:"md",label:s.value,onClick:k=>d("applyFilter",{event:k,idx:e,column:o,item:s,firstColumn:a.columns[0]})},null,8,["theme","label","onClick"])):f("",!0)])):o.type==="Check"?(t(),r("div",me,[n(I,{type:"checkbox",modelValue:s,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):(t(),r("div",{key:3,class:"truncate text-base",onClick:k=>d("applyFilter",{event:k,idx:e,column:o,item:s,firstColumn:a.columns[0]})},F(b),9,fe))]),_:2},1032,["item","align"]))]),_:1},8,["rows"]),n(u(Q),null,{actions:c(({selections:e,unselectAll:o})=>[n(u(te),{options:C.value.bulkActions(e,o)},{default:c(()=>[n(v,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["class","columns","rows","options"]),y.value?(t(),m(u(le),{key:0,class:"border-t sm:px-5 px-3 py-2",modelValue:y.value,"onUpdate:modelValue":l[3]||(l[3]=e=>y.value=e),options:{rowCount:a.options.rowCount,totalCount:a.options.totalCount},onLoadMore:l[4]||(l[4]=e=>d("loadMore"))},null,8,["modelValue","options"])):f("",!0),n(Y,{ref_key:"listBulkActionsRef",ref:C,modelValue:_.value,"onUpdate:modelValue":l[5]||(l[5]=e=>_.value=e),doctype:"CRM Deal"},null,8,["modelValue"])],64)}}};export{we as _};
//# sourceMappingURL=DealsListView-4c2e5303.js.map
