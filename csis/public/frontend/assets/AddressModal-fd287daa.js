import{F as $,_ as j}from"./QuickEntryModal-157d8856.js";import{E as D}from"./DragVerticalIcon-e7d3e46c.js";import{u as J}from"./index-31644aa3.js";import{i as z}from"./Link-4317fd36.js";import{m as L,i as B,l as d,j as P,z as b,I as q,k as R,e as C,f as i,c as k,b as c,w,d as n,t as T,u as r,g as V,p as h,a3 as G,aq as H,F as S,r as K,y as W,J as N}from"./index-85632e04.js";const X={class:"bg-surface-modal px-4 pb-6 pt-5 sm:px-6"},Y={class:"mb-5 flex items-center justify-between"},Z={class:"text-2xl font-semibold leading-6 text-ink-gray-9"},ee={class:"flex items-center gap-1"},se={key:0},ae={class:"px-4 pb-7 pt-4 sm:px-6"},te={class:"space-y-2"},ue={__name:"AddressModal",props:L({options:{type:Object,default:{afterInsert:()=>{}}}},{modelValue:{},modelModifiers:{},address:{},addressModifiers:{}}),emits:["update:modelValue","update:address"],setup(v){const A=v,{isManager:I}=J(),t=B(v,"modelValue"),x=B(v,"address"),u=d(!1),f=d(null);d(null);const m=d(!1);let l=d({name:"",address_title:"",address_type:"Billing",address_line1:"",address_line2:"",city:"",county:"",state:"",country:"",pincode:""});const _=P(()=>{let e=m.value?__(l.value.address_title):__("New Address"),s="xl",o=[{label:m.value?__("Save"):__("Create"),variant:"solid",onClick:()=>m.value?F():Q.submit()}];return{title:e,size:s,actions:o}}),M=b({url:"crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_fields_layout",cache:["QuickEntry","Address"],params:{doctype:"Address",type:"Quick Entry"},auto:!0});let y=d({});function F(){f.value=null;const e={...y.value},s={...l.value},o=JSON.stringify(e)!==JSON.stringify(s),g=s;if(!o){t.value=!1;return}u.value=!0,O.submit({doctype:"Address",name:l.value.name,fieldname:g})}const O=b({url:"frappe.client.set_value",onSuccess(e){u.value=!1,e.name&&E(e)},onError(e){u.value=!1,f.value=e}}),Q=b({url:"frappe.client.insert",makeParams(){return{doc:{doctype:"Address",...l.value}}},onSuccess(e){u.value=!1,e.name&&(q("address_created"),E(e))},onError(e){u.value=!1,f.value=e}});function E(e){t.value=!1,A.options.afterInsert&&A.options.afterInsert(e)}R(()=>t.value,e=>{e&&(m.value=!1,N(()=>{var s;y.value=((s=x.value)==null?void 0:s.doc)||x.value||{},l.value={...y.value},l.value.name&&(m.value=!0)}))});const p=d(!1);function U(){p.value=!0,N(()=>{t.value=!1})}return(e,s)=>{const o=C("Button"),g=C("Dialog");return i(),k(S,null,[c(g,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=a=>t.value=a),options:_.value},{body:w(()=>[n("div",X,[n("div",Y,[n("div",null,[n("h3",Z,T(e.__(_.value.title)||e.__("Untitled")),1)]),n("div",ee,[r(I)()&&!r(z)?(i(),V(o,{key:0,variant:"ghost",class:"w-7",onClick:U},{default:w(()=>[c(D,{class:"h-4 w-4"})]),_:1})):h("",!0),c(o,{variant:"ghost",class:"w-7",onClick:s[0]||(s[0]=a=>t.value=!1)},{default:w(()=>[c(r(G),{name:"x",class:"h-4 w-4"})]),_:1})])]),r(M).data?(i(),k("div",se,[c($,{tabs:r(M).data,data:r(l),doctype:"Address"},null,8,["tabs","data"]),c(r(H),{class:"mt-2",message:f.value},null,8,["message"])])):h("",!0)]),n("div",ae,[n("div",te,[(i(!0),k(S,null,K(_.value.actions,a=>(i(),V(o,W({class:"w-full",key:a.label,ref_for:!0},a,{label:e.__(a.label),loading:u.value}),null,16,["label","loading"]))),128))])])]),_:1},8,["modelValue","options"]),p.value?(i(),V(j,{key:0,modelValue:p.value,"onUpdate:modelValue":s[2]||(s[2]=a=>p.value=a),doctype:"Address"},null,8,["modelValue"])):h("",!0)],64)}}};export{ue as _};
//# sourceMappingURL=AddressModal-fd287daa.js.map
