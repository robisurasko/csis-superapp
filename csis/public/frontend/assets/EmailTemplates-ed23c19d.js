import{_ as q,a as H}from"./ViewControls-20f61d89.js";import{_ as O}from"./CustomActions-4107b940.js";import{E as J}from"./Email2Icon-d49a0a62.js";import{_ as G}from"./LayoutHeader-448e93da.js";import{m as j,i as N,j as M,s as K,k as Q,l as k,e as $,f as d,c as y,b as a,w as m,u as _,F as h,r as X,g as E,n as S,p as U,_ as Y,d as A,t as B,q as Z}from"./index-85632e04.js";import{_ as ee,H as R,a as te,b as le,c as oe,d as ae,e as se,f as ne}from"./ListRows-e4885bb7.js";import{_ as ie}from"./Dropdown.vue_vue_type_script_setup_true_lang-4f930b23.js";import{_ as ue}from"./ListFooter-fc834b42.js";import{_ as re}from"./EmailTemplateModal-adfdb337.js";import{b as de,f as I,t as me}from"./index-31644aa3.js";import"./FadedScrollableDiv-f3f408b5.js";import"./IconPicker-0c2832fa.js";import"./Popover-4a1551e7.js";import"./Link-4317fd36.js";import"./DragVerticalIcon-e7d3e46c.js";import"./PinIcon-6c6ca639.js";import"./DetailsIcon-404b02bf.js";import"./settings-5fcce07e.js";import"./AssignmentModal-f44425e3.js";import"./label-f9f1f609.js";const pe=["onClick"],fe={key:1,class:"truncate text-base"},ce={key:2},ve={key:3},ke=["onClick"],ye={__name:"EmailTemplatesListView",props:j({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:j(["loadMore","updatePageCount","showEmailTemplate","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(r,{expose:x,emit:L}){const p=L,g=N(r,"modelValue"),s=N(r,"list"),V=M(()=>{var i,n;return!!((n=(i=s.value.params)==null?void 0:i.filters)!=null&&n._liked_by)}),{user:F}=K();function w(i){if(i)return JSON.parse(i).includes(F)}Q(g,(i,n)=>{i!==n&&p("updatePageCount",i)});const c=k(null);return x({customListActions:M(()=>{var i;return(i=c.value)==null?void 0:i.customListActions})}),(i,n)=>{const b=$("Button"),T=$("Badge"),f=$("FormControl");return d(),y(h,null,[a(_(se),{columns:r.columns,rows:r.rows,options:{onRowClick:e=>p("showEmailTemplate",e.name),selectable:r.options.selectable,showTooltip:r.options.showTooltip,resizeColumn:r.options.resizeColumn},"row-key":"name","onUpdate:selections":n[2]||(n[2]=e=>p("selectionsChanged",e))},{default:m(()=>[a(_(ee),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:n[1]||(n[1]=e=>p("columnWidthUpdated"))},{default:m(()=>[(d(!0),y(h,null,X(r.columns,e=>(d(),E(_(te),{key:e.key,item:e,onColumnWidthUpdated:l=>p("columnWidthUpdated",e)},{default:m(()=>[e.key=="_liked_by"?(d(),E(b,{key:0,variant:"ghosted",class:S(["!h-4",V.value?"fill-red-500":"fill-white"]),onClick:n[0]||(n[0]=()=>p("applyLikeFilter"))},{default:m(()=>[a(R,{class:"h-4 w-4"})]),_:1},8,["class"])):U("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),a(le,{class:"mx-3 sm:mx-5",rows:r.rows,doctype:"Email Template"},{default:m(({idx:e,column:l,item:o})=>[a(_(oe),{item:o,align:l.align},{default:m(({label:t})=>[["modified","creation"].includes(l.key)?(d(),y("div",{key:0,class:"truncate text-base",onClick:C=>p("applyFilter",{event:C,idx:e,column:l,item:o,firstColumn:r.columns[0]})},[a(_(Y),{text:o.label},{default:m(()=>[A("div",null,B(o.timeAgo),1)]),_:2},1032,["text"])],8,pe)):l.key==="status"?(d(),y("div",fe,[a(T,{variant:"subtle",theme:o.color,size:"md",label:o.label,onClick:C=>p("applyFilter",{event:C,idx:e,column:l,item:o,firstColumn:r.columns[0]})},null,8,["theme","label","onClick"])])):l.type==="Check"?(d(),y("div",ce,[a(f,{type:"checkbox",modelValue:o,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):l.key==="_liked_by"?(d(),y("div",ve,[l.key=="_liked_by"?(d(),E(b,{key:0,variant:"ghosted",class:S(w(o)?"fill-red-500":"fill-white"),onClick:Z(()=>p("likeDoc",{name:i.row.name,liked:w(o)}),["stop","prevent"])},{default:m(()=>[a(R,{class:"h-4 w-4"})]),_:2},1032,["class","onClick"])):U("",!0)])):(d(),y("div",{key:4,class:"truncate text-base",onClick:C=>p("applyFilter",{event:C,idx:e,column:l,item:o,firstColumn:r.columns[0]})},B(t),9,ke))]),_:2},1032,["item","align"])]),_:1},8,["rows"]),a(_(ae),null,{actions:m(({selections:e,unselectAll:l})=>[a(_(ie),{options:c.value.bulkActions(e,l)},{default:m(()=>[a(b,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},8,["columns","rows","options"]),a(_(ue),{class:"border-t sm:px-5 px-3 py-2",modelValue:g.value,"onUpdate:modelValue":n[3]||(n[3]=e=>g.value=e),options:{rowCount:r.options.rowCount,totalCount:r.options.totalCount},onLoadMore:n[4]||(n[4]=e=>p("loadMore"))},null,8,["modelValue","options"]),a(ne,{ref_key:"listBulkActionsRef",ref:c,modelValue:s.value,"onUpdate:modelValue":n[5]||(n[5]=e=>s.value=e),doctype:"Email Template",options:{hideAssign:!0}},null,8,["modelValue"])],64)}}},Ce={key:1,class:"flex h-full items-center justify-center"},_e={class:"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4"},Ne={__name:"EmailTemplates",setup(r){const{getFormattedPercent:x,getFormattedFloat:L,getFormattedCurrency:p}=de("Email Template"),g=k(null),s=k({}),V=k(1),F=k(1),w=k(20),c=k(null),i=M(()=>{var f,e,l;return!((e=(f=s.value)==null?void 0:f.data)!=null&&e.data)||!["list","group_by"].includes(s.value.data.view_type)?[]:(l=s.value)==null?void 0:l.data.data.map(o=>{var C;let t={};return(C=s.value)==null||C.data.rows.forEach(u=>{var z,D,P;t[u]=o[u];let v=(P=(D=(z=s.value)==null?void 0:z.data.columns)==null?void 0:D.find(W=>(W.key||W.value)==u))==null?void 0:P.type;v&&["Date","Datetime"].includes(v)&&!["modified","creation"].includes(u)&&(t[u]=I(o[u],"",!0,v=="Datetime")),v&&v=="Currency"&&(t[u]=p(u,o)),v&&v=="Float"&&(t[u]=L(u,o)),v&&v=="Percent"&&(t[u]=x(u,o)),["modified","creation"].includes(u)&&(t[u]={label:I(o[u]),timeAgo:me(o[u])})}),t})}),n=k(!1),b=k({});function T(f){var e;if(!f)b.value={subject:"",response:"",response_html:"",name:"",enabled:1,use_html:0,owner:"",reference_doctype:"CRM Deal"};else{let l=(e=i.value)==null?void 0:e.find(o=>o.name===f);b.value={subject:l.subject,response:l.response,response_html:l.response_html,name:l.name,enabled:l.enabled,use_html:l.use_html,owner:l.owner,reference_doctype:l.reference_doctype}}n.value=!0}return(f,e)=>{const l=$("FeatherIcon"),o=$("Button");return d(),y(h,null,[a(G,null,{"left-header":m(()=>[a(H,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=t=>c.value=t),routeName:"Email Templates"},null,8,["modelValue"])]),"right-header":m(()=>{var t;return[(t=g.value)!=null&&t.customListActions?(d(),E(O,{key:0,actions:g.value.customListActions},null,8,["actions"])):U("",!0),a(o,{variant:"solid",label:f.__("Create"),onClick:e[1]||(e[1]=()=>T())},{prefix:m(()=>[a(l,{name:"plus",class:"h-4"})]),_:1},8,["label"])]}),_:1}),a(q,{ref_key:"viewControls",ref:c,modelValue:s.value,"onUpdate:modelValue":e[2]||(e[2]=t=>s.value=t),loadMore:V.value,"onUpdate:loadMore":e[3]||(e[3]=t=>V.value=t),resizeColumn:F.value,"onUpdate:resizeColumn":e[4]||(e[4]=t=>F.value=t),updatedPageCount:w.value,"onUpdate:updatedPageCount":e[5]||(e[5]=t=>w.value=t),doctype:"Email Template"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),s.value.data&&i.value.length?(d(),E(ye,{key:0,ref_key:"emailTemplatesListView",ref:g,modelValue:s.value.data.page_length_count,"onUpdate:modelValue":e[6]||(e[6]=t=>s.value.data.page_length_count=t),list:s.value,"onUpdate:list":e[7]||(e[7]=t=>s.value=t),rows:i.value,columns:s.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:s.value.data.row_count,totalCount:s.value.data.total_count},onLoadMore:e[8]||(e[8]=()=>V.value++),onColumnWidthUpdated:e[9]||(e[9]=()=>F.value++),onUpdatePageCount:e[10]||(e[10]=t=>w.value=t),onShowEmailTemplate:T,onApplyFilter:e[11]||(e[11]=t=>c.value.applyFilter(t)),onApplyLikeFilter:e[12]||(e[12]=t=>c.value.applyLikeFilter(t)),onLikeDoc:e[13]||(e[13]=t=>c.value.likeDoc(t)),onSelectionsChanged:e[14]||(e[14]=t=>c.value.updateSelections(t))},null,8,["modelValue","list","rows","columns","options"])):s.value.data?(d(),y("div",Ce,[A("div",_e,[a(J,{class:"h-10 w-10"}),A("span",null,B(f.__("No {0} Found",[f.__("Email Templates")])),1),a(o,{label:f.__("Create"),onClick:e[15]||(e[15]=()=>T())},{prefix:m(()=>[a(l,{name:"plus",class:"h-4"})]),_:1},8,["label"])])])):U("",!0),a(re,{modelValue:n.value,"onUpdate:modelValue":e[16]||(e[16]=t=>n.value=t),reloadEmailTemplates:s.value,"onUpdate:reloadEmailTemplates":e[17]||(e[17]=t=>s.value=t),emailTemplate:b.value},null,8,["modelValue","reloadEmailTemplates","emailTemplate"])],64)}}};export{Ne as default};
//# sourceMappingURL=EmailTemplates-ed23c19d.js.map
