{"version":3,"file":"Lead-6291e04c.js","sources":["../../../../frontend/src/pages/Lead.vue"],"sourcesContent":["<template>\n  <LayoutHeader v-if=\"lead.data\">\n    <template #left-header>\n      <Breadcrumbs :items=\"breadcrumbs\">\n        <template #prefix=\"{ item }\">\n          <Icon v-if=\"item.icon\" :icon=\"item.icon\" class=\"mr-2 h-4\" />\n        </template>\n      </Breadcrumbs>\n    </template>\n    <template #right-header>\n      <CustomActions\n        v-if=\"lead.data._customActions?.length\"\n        :actions=\"lead.data._customActions\"\n      />\n      <AssignTo\n        v-model=\"lead.data._assignedTo\"\n        :data=\"lead.data\"\n        doctype=\"CRM Lead\"\n      />\n      <Dropdown\n        :options=\"statusOptions('lead', updateField, lead.data._customStatuses)\"\n      >\n        <template #default=\"{ open }\">\n          <Button :label=\"lead.data.status\">\n            <template #prefix>\n              <IndicatorIcon :class=\"getLeadStatus(lead.data.status).color\" />\n            </template>\n            <template #suffix>\n              <FeatherIcon\n                :name=\"open ? 'chevron-up' : 'chevron-down'\"\n                class=\"h-4\"\n              />\n            </template>\n          </Button>\n        </template>\n      </Dropdown>\n      <Button\n        :label=\"__('Convert to Deal')\"\n        variant=\"solid\"\n        @click=\"showConvertToDealModal = true\"\n      />\n    </template>\n  </LayoutHeader>\n  <div v-if=\"lead?.data\" class=\"flex h-full overflow-hidden\">\n    <Tabs as=\"div\" v-model=\"tabIndex\" :tabs=\"tabs\">\n      <template #tab-panel>\n        <Activities\n          ref=\"activities\"\n          doctype=\"CRM Lead\"\n          :tabs=\"tabs\"\n          v-model:reload=\"reload\"\n          v-model:tabIndex=\"tabIndex\"\n          v-model=\"lead\"\n        />\n      </template>\n    </Tabs>\n    <Resizer class=\"flex flex-col justify-between border-l\" side=\"right\">\n      <div\n        class=\"flex h-10.5 cursor-copy items-center border-b px-5 py-2.5 text-lg font-medium text-ink-gray-9\"\n        @click=\"copyToClipboard(lead.data.name)\"\n      >\n        {{ __(lead.data.name) }}\n      </div>\n      <FileUploader\n        @success=\"(file) => updateField('image', file.file_url)\"\n        :validateFile=\"validateFile\"\n      >\n        <template #default=\"{ openFileSelector, error }\">\n          <div class=\"flex items-center justify-start gap-5 border-b p-5\">\n            <div class=\"group relative size-12\">\n              <Avatar\n                size=\"3xl\"\n                class=\"size-12\"\n                :label=\"title\"\n                :image=\"lead.data.image\"\n              />\n              <component\n                :is=\"lead.data.image ? Dropdown : 'div'\"\n                v-bind=\"\n                  lead.data.image\n                    ? {\n                        options: [\n                          {\n                            icon: 'upload',\n                            label: lead.data.image\n                              ? __('Change image')\n                              : __('Upload image'),\n                            onClick: openFileSelector,\n                          },\n                          {\n                            icon: 'trash-2',\n                            label: __('Remove image'),\n                            onClick: () => updateField('image', ''),\n                          },\n                        ],\n                      }\n                    : { onClick: openFileSelector }\n                \"\n                class=\"!absolute bottom-0 left-0 right-0\"\n              >\n                <div\n                  class=\"z-1 absolute bottom-0.5 left-0 right-0.5 flex h-9 cursor-pointer items-center justify-center rounded-b-full bg-black bg-opacity-40 pt-3 opacity-0 duration-300 ease-in-out group-hover:opacity-100\"\n                  style=\"\n                    -webkit-clip-path: inset(12px 0 0 0);\n                    clip-path: inset(12px 0 0 0);\n                  \"\n                >\n                  <CameraIcon class=\"size-4 cursor-pointer text-white\" />\n                </div>\n              </component>\n            </div>\n            <div class=\"flex flex-col gap-2.5 truncate\">\n              <Tooltip :text=\"lead.data.lead_name || __('Set first name')\">\n                <div class=\"truncate text-2xl font-medium text-ink-gray-9\">\n                  {{ title }}\n                </div>\n              </Tooltip>\n              <div class=\"flex gap-1.5\">\n                <Tooltip v-if=\"callEnabled\" :text=\"__('Make a call')\">\n                  <div>\n                    <Button\n                      class=\"h-7 w-7\"\n                      @click=\"\n                        () =>\n                          lead.data.mobile_no\n                            ? makeCall(lead.data.mobile_no)\n                            : toast.error(__('No phone number set'))\n                      \"\n                    >\n                      <PhoneIcon class=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </Tooltip>\n                <Tooltip :text=\"__('Send an email')\">\n                  <div>\n                    <Button class=\"h-7 w-7\">\n                      <Email2Icon\n                        class=\"h-4 w-4\"\n                        @click=\"\n                          lead.data.email\n                            ? openEmailBox()\n                            : toast.error(__('No email set'))\n                        \"\n                      />\n                    </Button>\n                  </div>\n                </Tooltip>\n                <Tooltip :text=\"__('Go to website')\">\n                  <div>\n                    <Button class=\"h-7 w-7\">\n                      <LinkIcon\n                        class=\"h-4 w-4\"\n                        @click=\"\n                          lead.data.website\n                            ? openWebsite(lead.data.website)\n                            : toast.error(__('No website set'))\n                        \"\n                      />\n                    </Button>\n                  </div>\n                </Tooltip>\n                <Tooltip :text=\"__('Attach a file')\">\n                  <div>\n                    <Button class=\"h-7 w-7\" @click=\"showFilesUploader = true\">\n                      <AttachmentIcon class=\"h-4 w-4\" />\n                    </Button>\n                  </div>\n                </Tooltip>\n              </div>\n              <ErrorMessage :message=\"__(error)\" />\n            </div>\n          </div>\n        </template>\n      </FileUploader>\n      <SLASection\n        v-if=\"lead.data.sla_status\"\n        v-model=\"lead.data\"\n        @updateField=\"updateField\"\n      />\n      <div\n        v-if=\"sections.data\"\n        class=\"flex flex-1 flex-col justify-between overflow-hidden\"\n      >\n        <SidePanelLayout\n          :sections=\"sections.data\"\n          doctype=\"CRM Lead\"\n          :docname=\"lead.data.name\"\n          @reload=\"sections.reload\"\n        />\n      </div>\n    </Resizer>\n  </div>\n  <ErrorPage\n    v-else-if=\"errorTitle\"\n    :errorTitle=\"errorTitle\"\n    :errorMessage=\"errorMessage\"\n  />\n  <Dialog\n    v-model=\"showConvertToDealModal\"\n    :options=\"{\n      size: 'xl',\n      actions: [\n        {\n          label: __('Convert'),\n          variant: 'solid',\n          onClick: convertToDeal,\n        },\n      ],\n    }\"\n  >\n    <template #body-header>\n      <div class=\"mb-6 flex items-center justify-between\">\n        <div>\n          <h3 class=\"text-2xl font-semibold leading-6 text-ink-gray-9\">\n            {{ __('Convert to Deal') }}\n          </h3>\n        </div>\n        <div class=\"flex items-center gap-1\">\n          <Button\n            v-if=\"isManager() && !isMobileView\"\n            variant=\"ghost\"\n            class=\"w-7\"\n            @click=\"openQuickEntryModal\"\n          >\n            <EditIcon class=\"h-4 w-4\" />\n          </Button>\n          <Button\n            variant=\"ghost\"\n            class=\"w-7\"\n            @click=\"showConvertToDealModal = false\"\n          >\n            <FeatherIcon name=\"x\" class=\"h-4 w-4\" />\n          </Button>\n        </div>\n      </div>\n    </template>\n    <template #body-content>\n      <div class=\"mb-4 flex items-center gap-2 text-ink-gray-5\">\n        <OrganizationsIcon class=\"h-4 w-4\" />\n        <label class=\"block text-base\">{{ __('Organization') }}</label>\n      </div>\n      <div class=\"ml-6 text-ink-gray-9\">\n        <div class=\"flex items-center justify-between text-base\">\n          <div>{{ __('Choose Existing') }}</div>\n          <Switch v-model=\"existingOrganizationChecked\" />\n        </div>\n        <Link\n          v-if=\"existingOrganizationChecked\"\n          class=\"form-control mt-2.5\"\n          size=\"md\"\n          :value=\"existingOrganization\"\n          doctype=\"CRM Organization\"\n          @change=\"(data) => (existingOrganization = data)\"\n        />\n        <div v-else class=\"mt-2.5 text-base\">\n          {{\n            __(\n              'New organization will be created based on the data in details section',\n            )\n          }}\n        </div>\n      </div>\n\n      <div class=\"mb-4 mt-6 flex items-center gap-2 text-ink-gray-5\">\n        <ContactsIcon class=\"h-4 w-4\" />\n        <label class=\"block text-base\">{{ __('Contact') }}</label>\n      </div>\n      <div class=\"ml-6 text-ink-gray-9\">\n        <div class=\"flex items-center justify-between text-base\">\n          <div>{{ __('Choose Existing') }}</div>\n          <Switch v-model=\"existingContactChecked\" />\n        </div>\n        <Link\n          v-if=\"existingContactChecked\"\n          class=\"form-control mt-2.5\"\n          size=\"md\"\n          :value=\"existingContact\"\n          doctype=\"Contact\"\n          @change=\"(data) => (existingContact = data)\"\n        />\n        <div v-else class=\"mt-2.5 text-base\">\n          {{ __(\"New contact will be created based on the person's details\") }}\n        </div>\n      </div>\n\n      <div v-if=\"dealTabs.data?.length\" class=\"h-px w-full border-t my-6\" />\n\n      <FieldLayout\n        v-if=\"dealTabs.data?.length\"\n        :tabs=\"dealTabs.data\"\n        :data=\"deal\"\n        doctype=\"CRM Deal\"\n      />\n    </template>\n  </Dialog>\n  <QuickEntryModal\n    v-if=\"showQuickEntryModal\"\n    v-model=\"showQuickEntryModal\"\n    doctype=\"CRM Deal\"\n    :onlyRequired=\"true\"\n  />\n  <FilesUploader\n    v-if=\"lead.data?.name\"\n    v-model=\"showFilesUploader\"\n    doctype=\"CRM Lead\"\n    :docname=\"lead.data.name\"\n    @after=\"\n      () => {\n        activities?.all_activities?.reload()\n        changeTabTo('attachments')\n      }\n    \"\n  />\n</template>\n<script setup>\nimport ErrorPage from '@/components/ErrorPage.vue'\nimport Icon from '@/components/Icon.vue'\nimport Resizer from '@/components/Resizer.vue'\nimport ActivityIcon from '@/components/Icons/ActivityIcon.vue'\nimport EmailIcon from '@/components/Icons/EmailIcon.vue'\nimport Email2Icon from '@/components/Icons/Email2Icon.vue'\nimport CommentIcon from '@/components/Icons/CommentIcon.vue'\nimport DetailsIcon from '@/components/Icons/DetailsIcon.vue'\nimport PhoneIcon from '@/components/Icons/PhoneIcon.vue'\nimport TaskIcon from '@/components/Icons/TaskIcon.vue'\nimport NoteIcon from '@/components/Icons/NoteIcon.vue'\nimport WhatsAppIcon from '@/components/Icons/WhatsAppIcon.vue'\nimport IndicatorIcon from '@/components/Icons/IndicatorIcon.vue'\nimport CameraIcon from '@/components/Icons/CameraIcon.vue'\nimport LinkIcon from '@/components/Icons/LinkIcon.vue'\nimport OrganizationsIcon from '@/components/Icons/OrganizationsIcon.vue'\nimport ContactsIcon from '@/components/Icons/ContactsIcon.vue'\nimport AttachmentIcon from '@/components/Icons/AttachmentIcon.vue'\nimport EditIcon from '@/components/Icons/EditIcon.vue'\nimport LayoutHeader from '@/components/LayoutHeader.vue'\nimport Activities from '@/components/Activities/Activities.vue'\nimport AssignTo from '@/components/AssignTo.vue'\nimport FilesUploader from '@/components/FilesUploader/FilesUploader.vue'\nimport Link from '@/components/Controls/Link.vue'\nimport SidePanelLayout from '@/components/SidePanelLayout.vue'\nimport FieldLayout from '@/components/FieldLayout/FieldLayout.vue'\nimport QuickEntryModal from '@/components/Modals/QuickEntryModal.vue'\nimport SLASection from '@/components/SLASection.vue'\nimport CustomActions from '@/components/CustomActions.vue'\nimport {\n  openWebsite,\n  setupAssignees,\n  setupCustomizations,\n  copyToClipboard,\n} from '@/utils'\nimport { getView } from '@/utils/view'\nimport { getSettings } from '@/stores/settings'\nimport { sessionStore } from '@/stores/session'\nimport { usersStore } from '@/stores/users'\nimport { globalStore } from '@/stores/global'\nimport { statusesStore } from '@/stores/statuses'\nimport { getMeta } from '@/stores/meta'\nimport { useDocument } from '@/data/document'\nimport {\n  whatsappEnabled,\n  callEnabled,\n  isMobileView,\n} from '@/composables/settings'\nimport { capture } from '@/telemetry'\nimport {\n  createResource,\n  FileUploader,\n  Dropdown,\n  Tooltip,\n  Avatar,\n  Tabs,\n  Switch,\n  Breadcrumbs,\n  call,\n  usePageMeta,\n  toast,\n} from 'frappe-ui'\nimport { useOnboarding } from 'frappe-ui/frappe'\nimport { ref, reactive, computed, onMounted, watch } from 'vue'\nimport { useRouter, useRoute } from 'vue-router'\nimport { useActiveTabManager } from '@/composables/useActiveTabManager'\n\nconst { brand } = getSettings()\nconst { user } = sessionStore()\nconst { isManager } = usersStore()\nconst { $dialog, $socket, makeCall } = globalStore()\nconst { statusOptions, getLeadStatus, getDealStatus } = statusesStore()\nconst { doctypeMeta } = getMeta('CRM Lead')\n\nconst { updateOnboardingStep } = useOnboarding('frappecrm')\n\nconst route = useRoute()\nconst router = useRouter()\n\nconst props = defineProps({\n  leadId: {\n    type: String,\n    required: true,\n  },\n})\n\nconst errorTitle = ref('')\nconst errorMessage = ref('')\n\nconst lead = createResource({\n  url: 'crm.fcrm.doctype.crm_lead.api.get_lead',\n  params: { name: props.leadId },\n  cache: ['lead', props.leadId],\n  onSuccess: (data) => {\n    errorTitle.value = ''\n    errorMessage.value = ''\n    setupAssignees(lead)\n    setupCustomizations(lead, {\n      doc: data,\n      $dialog,\n      $socket,\n      router,\n      toast,\n      updateField,\n      createToast: toast.create,\n      deleteDoc: deleteLead,\n      resource: { lead, sections },\n      call,\n    })\n  },\n  onError: (err) => {\n    if (err.messages?.[0]) {\n      errorTitle.value = __('Not permitted')\n      errorMessage.value = __(err.messages?.[0])\n    } else {\n      router.push({ name: 'Leads' })\n    }\n  },\n})\n\nonMounted(() => {\n  if (lead.data) return\n  lead.fetch()\n})\n\nconst reload = ref(false)\nconst showFilesUploader = ref(false)\n\nfunction updateLead(fieldname, value, callback) {\n  value = Array.isArray(fieldname) ? '' : value\n\n  if (!Array.isArray(fieldname) && validateRequired(fieldname, value)) return\n\n  createResource({\n    url: 'frappe.client.set_value',\n    params: {\n      doctype: 'CRM Lead',\n      name: props.leadId,\n      fieldname,\n      value,\n    },\n    auto: true,\n    onSuccess: () => {\n      lead.reload()\n      reload.value = true\n      toast.success(__('Lead updated successfully'))\n      callback?.()\n    },\n    onError: (err) => {\n      toast.error(err.messages?.[0] || __('Error updating lead'))\n    },\n  })\n}\n\nfunction validateRequired(fieldname, value) {\n  let meta = lead.data.fields_meta || {}\n  if (meta[fieldname]?.reqd && !value) {\n    toast.error(__('{0} is a required field', [meta[fieldname].label]))\n    return true\n  }\n  return false\n}\n\nconst breadcrumbs = computed(() => {\n  let items = [{ label: __('Leads'), route: { name: 'Leads' } }]\n\n  if (route.query.view || route.query.viewType) {\n    let view = getView(route.query.view, route.query.viewType, 'CRM Lead')\n    if (view) {\n      items.push({\n        label: __(view.label),\n        icon: view.icon,\n        route: {\n          name: 'Leads',\n          params: { viewType: route.query.viewType },\n          query: { view: route.query.view },\n        },\n      })\n    }\n  }\n\n  items.push({\n    label: title.value,\n    route: { name: 'Lead', params: { leadId: lead.data.name } },\n  })\n  return items\n})\n\nconst title = computed(() => {\n  let t = doctypeMeta['CRM Lead']?.title_field || 'name'\n  return lead.data?.[t] || props.leadId\n})\n\nusePageMeta(() => {\n  return {\n    title: title.value,\n    icon: brand.favicon,\n  }\n})\n\nconst tabs = computed(() => {\n  let tabOptions = [\n    {\n      name: 'Activity',\n      label: __('Activity'),\n      icon: ActivityIcon,\n    },\n    {\n      name: 'Emails',\n      label: __('Emails'),\n      icon: EmailIcon,\n    },\n    {\n      name: 'Comments',\n      label: __('Comments'),\n      icon: CommentIcon,\n    },\n    {\n      name: 'Data',\n      label: __('Data'),\n      icon: DetailsIcon,\n    },\n    {\n      name: 'Calls',\n      label: __('Calls'),\n      icon: PhoneIcon,\n    },\n    {\n      name: 'Tasks',\n      label: __('Tasks'),\n      icon: TaskIcon,\n    },\n    {\n      name: 'Notes',\n      label: __('Notes'),\n      icon: NoteIcon,\n    },\n    {\n      name: 'Attachments',\n      label: __('Attachments'),\n      icon: AttachmentIcon,\n    },\n    {\n      name: 'WhatsApp',\n      label: __('WhatsApp'),\n      icon: WhatsAppIcon,\n      condition: () => whatsappEnabled.value,\n    },\n  ]\n  return tabOptions.filter((tab) => (tab.condition ? tab.condition() : true))\n})\n\nconst { tabIndex, changeTabTo } = useActiveTabManager(tabs, 'lastLeadTab')\n\nwatch(tabs, (value) => {\n  if (value && route.params.tabName) {\n    let index = value.findIndex(\n      (tab) => tab.name.toLowerCase() === route.params.tabName.toLowerCase(),\n    )\n    if (index !== -1) {\n      tabIndex.value = index\n    }\n  }\n})\n\nfunction validateFile(file) {\n  let extn = file.name.split('.').pop().toLowerCase()\n  if (!['png', 'jpg', 'jpeg'].includes(extn)) {\n    return __('Only PNG and JPG images are allowed')\n  }\n}\n\nconst sections = createResource({\n  url: 'crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_sidepanel_sections',\n  cache: ['sidePanelSections', 'CRM Lead'],\n  params: { doctype: 'CRM Lead' },\n  auto: true,\n})\n\nfunction updateField(name, value, callback) {\n  updateLead(name, value, () => {\n    lead.data[name] = value\n    callback?.()\n  })\n}\n\nasync function deleteLead(name) {\n  await call('frappe.client.delete', {\n    doctype: 'CRM Lead',\n    name,\n  })\n  router.push({ name: 'Leads' })\n}\n\n// Convert to Deal\nconst showConvertToDealModal = ref(false)\nconst existingContactChecked = ref(false)\nconst existingOrganizationChecked = ref(false)\n\nconst existingContact = ref('')\nconst existingOrganization = ref('')\n\nconst { triggerConvertToDeal } = useDocument('CRM Lead', props.leadId)\n\nasync function convertToDeal() {\n  if (existingContactChecked.value && !existingContact.value) {\n    toast.error(__('Please select an existing contact'))\n    return\n  }\n\n  if (existingOrganizationChecked.value && !existingOrganization.value) {\n    toast.error(__('Please select an existing organization'))\n    return\n  }\n\n  if (!existingContactChecked.value && existingContact.value) {\n    existingContact.value = ''\n  }\n\n  if (!existingOrganizationChecked.value && existingOrganization.value) {\n    existingOrganization.value = ''\n  }\n\n  await triggerConvertToDeal?.(\n    lead.data,\n    deal,\n    () => (showConvertToDealModal.value = false),\n  )\n\n  let _deal = await call('crm.fcrm.doctype.crm_lead.crm_lead.convert_to_deal', {\n    lead: lead.data.name,\n    deal,\n    existing_contact: existingContact.value,\n    existing_organization: existingOrganization.value,\n  }).catch((err) => {\n    toast.error(__('Error converting to deal: {0}', [err.messages?.[0]]))\n  })\n  if (_deal) {\n    showConvertToDealModal.value = false\n    existingContactChecked.value = false\n    existingOrganizationChecked.value = false\n    existingContact.value = ''\n    existingOrganization.value = ''\n    updateOnboardingStep('convert_lead_to_deal', true, false, () => {\n      localStorage.setItem('firstDeal' + user, _deal)\n    })\n    capture('convert_lead_to_deal')\n    router.push({ name: 'Deal', params: { dealId: _deal } })\n  }\n}\n\nconst activities = ref(null)\n\nfunction openEmailBox() {\n  activities.value.emailBox.show = true\n}\n\nconst deal = reactive({})\n\nconst dealStatuses = computed(() => {\n  let statuses = statusOptions('deal')\n  if (!deal.status) {\n    deal.status = statuses[0].value\n  }\n  return statuses\n})\n\nconst dealTabs = createResource({\n  url: 'crm.fcrm.doctype.crm_fields_layout.crm_fields_layout.get_fields_layout',\n  cache: ['RequiredFields', 'CRM Deal'],\n  params: { doctype: 'CRM Deal', type: 'Required Fields' },\n  auto: true,\n  transform: (_tabs) => {\n    let hasFields = false\n    let parsedTabs = _tabs?.forEach((tab) => {\n      tab.sections?.forEach((section) => {\n        section.columns?.forEach((column) => {\n          column.fields?.forEach((field) => {\n            hasFields = true\n            if (field.fieldname == 'status') {\n              field.fieldtype = 'Select'\n              field.options = dealStatuses.value\n              field.prefix = getDealStatus(deal.status).color\n            }\n\n            if (field.fieldtype === 'Table') {\n              deal[field.fieldname] = []\n            }\n          })\n        })\n      })\n    })\n    return hasFields ? parsedTabs : []\n  },\n})\n\nconst showQuickEntryModal = ref(false)\n\nfunction openQuickEntryModal() {\n  showQuickEntryModal.value = true\n  showConvertToDealModal.value = false\n}\n</script>\n"],"names":["brand","getSettings","user","sessionStore","isManager","usersStore","$dialog","$socket","makeCall","globalStore","statusOptions","getLeadStatus","getDealStatus","statusesStore","doctypeMeta","getMeta","updateOnboardingStep","useOnboarding","route","useRoute","router","useRouter","props","__props","errorTitle","ref","errorMessage","lead","createResource","data","setupAssignees","setupCustomizations","toast","updateField","deleteLead","sections","call","err","_a","_b","onMounted","reload","showFilesUploader","updateLead","fieldname","value","callback","validateRequired","meta","breadcrumbs","computed","items","view","getView","title","t","usePageMeta","tabs","ActivityIcon","EmailIcon","CommentIcon","DetailsIcon","PhoneIcon","TaskIcon","NoteIcon","AttachmentIcon","WhatsAppIcon","whatsappEnabled","tab","tabIndex","changeTabTo","useActiveTabManager","watch","index","validateFile","file","extn","name","showConvertToDealModal","existingContactChecked","existingOrganizationChecked","existingContact","existingOrganization","triggerConvertToDeal","useDocument","convertToDeal","deal","_deal","capture","activities","openEmailBox","reactive","dealStatuses","statuses","dealTabs","_tabs","hasFields","parsedTabs","section","column","field","showQuickEntryModal","openQuickEntryModal"],"mappings":"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"}