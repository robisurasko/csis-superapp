import{_ as W,a as N}from"./ViewControls-20f61d89.js";import{_ as S}from"./CustomActions-4107b940.js";import{P as T}from"./PhoneIcon-cb5df69f.js";import{_ as j}from"./LayoutHeader-448e93da.js";import{m as P,i as D,j as h,s as q,k as E,l as c,e as w,f as u,c as p,b as a,w as d,u as v,F as A,r as H,g as V,n as R,p as b,_ as O,d as B,t as z,q as J,y as G,z as K}from"./index-85632e04.js";import{_ as Q,H as I,a as X,b as Y,c as Z,d as ee,e as le,f as oe}from"./ListRows-e4885bb7.js";import{a as te}from"./index-31644aa3.js";import{_ as ae}from"./Dropdown.vue_vue_type_script_setup_true_lang-4f930b23.js";import{_ as se}from"./ListFooter-fc834b42.js";import{C as ne,_ as ie,g as ue}from"./CallLogModal-359f4190.js";import"./FadedScrollableDiv-f3f408b5.js";import"./IconPicker-0c2832fa.js";import"./Popover-4a1551e7.js";import"./Link-4317fd36.js";import"./DragVerticalIcon-e7d3e46c.js";import"./PinIcon-6c6ca639.js";import"./DetailsIcon-404b02bf.js";import"./settings-5fcce07e.js";import"./AssignmentModal-f44425e3.js";import"./label-f9f1f609.js";import"./ArrowUpRightIcon-fffd9b01.js";import"./ContactsIcon-830ef67e.js";import"./LeadsIcon-68ebc4cc.js";import"./DealsIcon-acabc22f.js";import"./CalendarIcon-b9320815.js";import"./NoteModal-4abb9e0a.js";import"./helpCenter-64650aa2.js";import"./TaskIcon-f5c3d969.js";import"./TaskModal-d0e5aa30.js";import"./QuickEntryModal-157d8856.js";import"./Section-7d029c27.js";import"./IndicatorIcon-99f76624.js";const re={key:0},de={key:1},me=["onClick"],pe={key:1,class:"truncate text-base"},ce={key:2},fe={key:3},ve=["onClick"],ge={__name:"CallLogsListView",props:P({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:P(["showCallLog","loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(r,{expose:M,emit:C}){const o=C,k=D(r,"modelValue"),y=D(r,"list"),U=h(()=>{var s,n;return!!((n=(s=y.value.params)==null?void 0:s.filters)!=null&&n._liked_by)}),{user:f}=q();function $(s){if(s)return JSON.parse(s).includes(f)}E(k,(s,n)=>{s!==n&&o("updatePageCount",s)});const _=c(null);return M({customListActions:h(()=>{var s;return(s=_.value)==null?void 0:s.customListActions})}),(s,n)=>{const F=w("Button"),m=w("FeatherIcon"),l=w("Badge"),L=w("FormControl");return u(),p(A,null,[a(v(le),G({columns:r.columns,rows:r.rows,options:{onRowClick:t=>o("showCallLog",t.name),selectable:r.options.selectable,showTooltip:r.options.showTooltip,resizeColumn:r.options.resizeColumn},"row-key":"name"},s.$attrs,{"onUpdate:selections":n[2]||(n[2]=t=>o("selectionsChanged",t))}),{default:d(()=>[a(v(Q),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:n[1]||(n[1]=t=>o("columnWidthUpdated"))},{default:d(()=>[(u(!0),p(A,null,H(r.columns,t=>(u(),V(v(X),{key:t.key,item:t,onColumnWidthUpdated:e=>o("columnWidthUpdated",t)},{default:d(()=>[t.key=="_liked_by"?(u(),V(F,{key:0,variant:"ghosted",class:R(["!h-4",U.value?"fill-red-500":"fill-white"]),onClick:n[0]||(n[0]=()=>o("applyLikeFilter"))},{default:d(()=>[a(I,{class:"h-4 w-4"})]),_:1},8,["class"])):b("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),a(Y,{class:"mx-3 sm:mx-5",rows:r.rows,doctype:"CRM Call Log"},{default:d(({idx:t,column:e,item:i})=>[a(v(Z),{item:i,align:e.align},{prefix:d(()=>[["caller","receiver"].includes(e.key)?(u(),p("div",re,[i.label?(u(),V(v(te),{key:0,class:"flex items-center",image:i.image,label:i.label,size:"sm"},null,8,["image","label"])):b("",!0)])):["type","duration"].includes(e.key)?(u(),p("div",de,[a(m,{name:i.icon,class:"h-3 w-3"},null,8,["name"])])):b("",!0)]),default:d(({label:x})=>[["modified","creation"].includes(e.key)?(u(),p("div",{key:0,class:"truncate text-base",onClick:g=>o("applyFilter",{event:g,idx:t,column:e,item:i,firstColumn:r.columns[0]})},[a(v(O),{text:i.label},{default:d(()=>[B("div",null,z(i.timeAgo),1)]),_:2},1032,["text"])],8,me)):e.key==="status"?(u(),p("div",pe,[a(l,{variant:"subtle",theme:i.color,size:"md",label:s.__(i.label),onClick:g=>o("applyFilter",{event:g,idx:t,column:e,item:i,firstColumn:r.columns[0]})},null,8,["theme","label","onClick"])])):e.type==="Check"?(u(),p("div",ce,[a(L,{type:"checkbox",modelValue:i,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):e.key==="_liked_by"?(u(),p("div",fe,[e.key=="_liked_by"?(u(),V(F,{key:0,variant:"ghosted",class:R($(i)?"fill-red-500":"fill-white"),onClick:J(()=>o("likeDoc",{name:s.row.name,liked:$(i)}),["stop","prevent"])},{default:d(()=>[a(I,{class:"h-4 w-4"})]),_:2},1032,["class","onClick"])):b("",!0)])):(u(),p("div",{key:4,class:"truncate text-base",onClick:g=>o("applyFilter",{event:g,idx:t,column:e,item:i,firstColumn:r.columns[0]})},z(x),9,ve))]),_:2},1032,["item","align"])]),_:1},8,["rows"]),a(v(ee),null,{actions:d(({selections:t,unselectAll:e})=>[a(v(ae),{options:_.value.bulkActions(t,e)},{default:d(()=>[a(F,{icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"])]),_:1})]),_:1},16,["columns","rows","options"]),a(v(se),{class:"border-t sm:px-5 px-3 py-2",modelValue:k.value,"onUpdate:modelValue":n[3]||(n[3]=t=>k.value=t),options:{rowCount:r.options.rowCount,totalCount:r.options.totalCount},onLoadMore:n[4]||(n[4]=t=>o("loadMore"))},null,8,["modelValue","options"]),a(oe,{ref_key:"listBulkActionsRef",ref:_,modelValue:y.value,"onUpdate:modelValue":n[5]||(n[5]=t=>y.value=t),doctype:"CRM Call Log",options:{hideEdit:!0,hideAssign:!0}},null,8,["modelValue"])],64)}}},Ce={key:1,class:"flex h-full items-center justify-center"},ke={class:"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4"},Xe={__name:"CallLogs",setup(r){const M=c(null),C=c(!1),o=c({}),k=c(1),y=c(1),U=c(20),f=c(null),$=h(()=>{var m,l,L;return!((l=(m=o.value)==null?void 0:m.data)!=null&&l.data)||!["list","group_by"].includes(o.value.data.view_type)?[]:(L=o.value)==null?void 0:L.data.data.map(t=>{var i;let e={};return(i=o.value)==null||i.data.rows.forEach(x=>{var g;e[x]=ue(x,t,(g=o.value)==null?void 0:g.data.columns)}),e})}),_=c(!1),s=c({});function n(m){_.value=!0,s.value=K({url:"crm.fcrm.doctype.crm_call_log.crm_call_log.get_call_log",params:{name:m},cache:["call_log",m],auto:!0})}function F(){s.value={},C.value=!0}return(m,l)=>{const L=w("FeatherIcon"),t=w("Button");return u(),p(A,null,[a(j,null,{"left-header":d(()=>[a(N,{modelValue:f.value,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value=e),routeName:"Call Logs"},null,8,["modelValue"])]),"right-header":d(()=>{var e;return[(e=M.value)!=null&&e.customListActions?(u(),V(S,{key:0,actions:M.value.customListActions},null,8,["actions"])):b("",!0),a(t,{variant:"solid",label:m.__("Create"),onClick:F},{prefix:d(()=>[a(L,{name:"plus",class:"h-4"})]),_:1},8,["label"])]}),_:1}),a(W,{ref_key:"viewControls",ref:f,modelValue:o.value,"onUpdate:modelValue":l[1]||(l[1]=e=>o.value=e),loadMore:k.value,"onUpdate:loadMore":l[2]||(l[2]=e=>k.value=e),resizeColumn:y.value,"onUpdate:resizeColumn":l[3]||(l[3]=e=>y.value=e),updatedPageCount:U.value,"onUpdate:updatedPageCount":l[4]||(l[4]=e=>U.value=e),doctype:"CRM Call Log"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),o.value.data&&$.value.length?(u(),V(ge,{key:0,ref_key:"callLogsListView",ref:M,modelValue:o.value.data.page_length_count,"onUpdate:modelValue":l[5]||(l[5]=e=>o.value.data.page_length_count=e),list:o.value,"onUpdate:list":l[6]||(l[6]=e=>o.value=e),rows:$.value,columns:o.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:o.value.data.row_count,totalCount:o.value.data.total_count},onShowCallLog:n,onLoadMore:l[7]||(l[7]=()=>k.value++),onColumnWidthUpdated:l[8]||(l[8]=()=>y.value++),onUpdatePageCount:l[9]||(l[9]=e=>U.value=e),onApplyFilter:l[10]||(l[10]=e=>f.value.applyFilter(e)),onApplyLikeFilter:l[11]||(l[11]=e=>f.value.applyLikeFilter(e)),onLikeDoc:l[12]||(l[12]=e=>f.value.likeDoc(e)),onSelectionsChanged:l[13]||(l[13]=e=>f.value.updateSelections(e))},null,8,["modelValue","list","rows","columns","options"])):o.value.data?(u(),p("div",Ce,[B("div",ke,[a(T,{class:"h-10 w-10"}),B("span",null,z(m.__("No {0} Found",[m.__("Logs")])),1)])])):b("",!0),a(ne,{modelValue:_.value,"onUpdate:modelValue":l[14]||(l[14]=e=>_.value=e),callLogModal:C.value,"onUpdate:callLogModal":l[15]||(l[15]=e=>C.value=e),callLog:s.value,"onUpdate:callLog":l[16]||(l[16]=e=>s.value=e)},null,8,["modelValue","callLogModal","callLog"]),a(ie,{modelValue:C.value,"onUpdate:modelValue":l[17]||(l[17]=e=>C.value=e),callLog:s.value,"onUpdate:callLog":l[18]||(l[18]=e=>s.value=e),options:{afterInsert:()=>o.value.reload()}},null,8,["modelValue","callLog","options"])],64)}}};export{Xe as default};
//# sourceMappingURL=CallLogs-f8e06f1a.js.map
