import{m as B,i as G,j as x,e as D,f as i,c,g as y,w as u,d as n,b as s,n as F,u as m,F as j,r as z,t as k,C as H,y as E,a6 as C,at as I,au as R,p as g,q as J}from"./index-85632e04.js";import{a as Q}from"./Link-4317fd36.js";import{b as U}from"./FadedScrollableDiv-f3f408b5.js";import{I as L}from"./IndicatorIcon-99f76624.js";import{x as P,y as w,z as S}from"./index-31644aa3.js";import{D as A}from"./DragVerticalIcon-e7d3e46c.js";import{_ as W}from"./Dropdown.vue_vue_type_script_setup_true_lang-4f930b23.js";const X={class:"flex overflow-x-auto h-full"},Y={key:0,class:"flex flex-col gap-2.5 min-w-72 w-72 hover:bg-surface-gray-2 rounded-lg p-2.5"},Z={class:"flex gap-2 items-center group justify-between"},ee={class:"flex items-center text-base"},te={class:"flex flex-col gap-3 px-3 py-2.5 min-w-40 rounded-lg bg-surface-modal shadow-2xl ring-1 ring-black ring-opacity-5 focus:outline-none"},le={class:"flex gap-1"},oe={class:"flex flex-row-reverse"},ae={class:"text-ink-gray-9"},ne={class:"flex"},se={class:"overflow-y-auto flex flex-col gap-2 h-full"},ie={class:"h-5 flex items-center"},re={key:0},ue={key:1,class:"text-ink-gray-4"},ce={class:"flex flex-col gap-3.5"},me={key:0,class:"truncate"},de={class:"flex gap-2 items-center justify-between"},fe={key:0,class:"flex items-center justify-center"},pe={key:1,class:"shrink-0 min-w-64"},ye={__name:"KanbanView",props:B({options:{type:Object,default:()=>({getRoute:null,onClick:null,onNewClick:null})}},{modelValue:{},modelModifiers:{}}),emits:B(["update","loadMore"],["update:modelValue"]),setup(d,{emit:O}){const N=O,h=G(d,"modelValue"),b=x(()=>{var e,o;return(o=(e=h.value)==null?void 0:e.data)==null?void 0:o.title_field}),p=x(()=>{var a,f;if(!((f=(a=h.value)==null?void 0:a.data)!=null&&f.data)||h.value.data.view_type!="kanban")return[];let e=h.value.data.data;return e.some(t=>{var l;return(l=t.column)==null?void 0:l.color})||e.forEach((t,l)=>{t.column.color=w[l%w.length]}),e}),$=x(()=>p.value.filter(e=>e.column.delete).map(e=>({label:e.column.name,value:e.column.name})));function T(e){return[{group:__("Options"),hideLabel:!0,items:[{label:__("Delete"),icon:"trash-2",onClick:()=>{e.column.delete=!0,_()}}]}]}function q(e){let o=p.value.find(a=>a.column.name==e.value);o.column.delete=!1,_()}function _(e){var r,M,V;let o=(r=e==null?void 0:e.to)==null?void 0:r.dataset.column,a=(M=e==null?void 0:e.from)==null?void 0:M.dataset.column,f=(V=e==null?void 0:e.item)==null?void 0:V.dataset.name,t=[];p.value.forEach(v=>{v.column.order=v.data.map(K=>K.name),v.column.page_length&&delete v.column.page_length,t.push(v.column)});let l={kanban_columns:t};o!=a&&(l={item:f,to:o,kanban_columns:t}),N("update",l)}return(e,o)=>{const a=D("Button"),f=D("FeatherIcon");return i(),c("div",X,[p.value?(i(),y(m(A),{key:0,list:p.value,"item-key":"column",onEnd:_,delay:m(S)()?200:0,class:"flex sm:mx-2.5 mx-2 pb-3.5"},{item:u(({element:t})=>[t.column.delete?g("",!0):(i(),c("div",Y,[n("div",Z,[n("div",ee,[s(U,null,{target:u(()=>[s(a,{variant:"ghost",size:"sm",class:"hover:!bg-surface-gray-2"},{default:u(()=>[s(L,{class:F(m(P)(t.column.color))},null,8,["class"])]),_:2},1024)]),body:u(({close:l})=>[n("div",te,[n("div",le,[(i(!0),c(j,null,z(m(w),r=>(i(),y(a,{variant:"ghost",key:r,onClick:()=>t.column.color=r},{default:u(()=>[s(L,{class:F(m(P)(r))},null,8,["class"])]),_:2},1032,["onClick"]))),128))]),n("div",oe,[s(a,{variant:"solid",label:e.__("Apply"),onClick:_},null,8,["label"])])])]),_:2},1024),n("div",ae,k(t.column.name),1)]),n("div",ne,[s(m(W),{options:T(t)},{default:u(()=>[s(a,{class:"hidden group-hover:flex",icon:"more-horizontal",variant:"ghost"})]),_:2},1032,["options"]),s(a,{icon:"plus",variant:"ghost",onClick:l=>d.options.onNewClick(t)},null,8,["onClick"])])]),n("div",se,[s(m(A),{list:t.data,group:"fields","item-key":"name",class:"flex flex-col gap-3.5 flex-1",onEnd:_,delay:m(S)()?200:0,"data-column":t.column.name},{item:u(({element:l})=>[(i(),y(H(d.options.getRoute?"router-link":"div"),E({class:"pt-3 px-3.5 pb-2.5 rounded-lg border bg-surface-white text-base flex flex-col text-ink-gray-9","data-name":l.name},{to:d.options.getRoute?d.options.getRoute(l):void 0,onClick:d.options.onClick?()=>d.options.onClick(l):void 0}),{default:u(()=>[C(e.$slots,"title",I(R({fields:l,titleField:b.value,itemName:l.name})),()=>[n("div",ie,[l[b.value]?(i(),c("div",re,k(l[b.value]),1)):(i(),c("div",ue,k(e.__("No Title")),1))])]),o[3]||(o[3]=n("div",{class:"border-b h-px my-2.5"},null,-1)),n("div",ce,[(i(!0),c(j,null,z(t.fields,r=>C(e.$slots,"fields",E({key:r,ref_for:!0},{fields:l,fieldName:r,itemName:l.name}),()=>[l[r]?(i(),c("div",me,k(l[r]),1)):g("",!0)])),128))]),o[4]||(o[4]=n("div",{class:"border-b h-px mt-2.5 mb-2"},null,-1)),C(e.$slots,"actions",I(R({itemName:l.name})),()=>[n("div",de,[o[2]||(o[2]=n("div",null,null,-1)),s(a,{icon:"plus",variant:"ghost",onClick:o[0]||(o[0]=J(()=>{},["stop","prevent"]))})])])]),_:2},1040,["data-name"]))]),_:2},1032,["list","delay","data-column"]),t.column.count<t.column.all_count?(i(),c("div",fe,[s(a,{label:e.__("Load More"),onClick:l=>N("loadMore",t.column.name)},null,8,["label","onClick"])])):g("",!0)])]))]),_:3},8,["list","delay"])):g("",!0),$.value.length?(i(),c("div",pe,[s(Q,{value:"",options:$.value,onChange:o[1]||(o[1]=t=>q(t))},{target:u(({togglePopover:t})=>[s(a,{class:"w-full mt-2.5 mb-1 mr-5",onClick:l=>t(),label:e.__("Add Column")},{prefix:u(()=>[s(f,{name:"plus",class:"h-4"})]),_:2},1032,["onClick","label"])]),_:1},8,["options"])])):g("",!0)])}}};export{ye as _};
//# sourceMappingURL=KanbanView-a348c3f4.js.map
